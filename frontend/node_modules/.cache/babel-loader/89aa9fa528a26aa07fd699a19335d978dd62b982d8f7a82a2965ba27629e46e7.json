{"ast":null,"code":"import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withDirectives as _withDirectives } from \"vue\";\nconst _hoisted_1 = {\n  class: \"two-factor-setup\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"setup-section\"\n};\nconst _hoisted_3 = {\n  key: 1,\n  class: \"verification-section\"\n};\nexport function render(_ctx, _cache) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [!_ctx.isEnabled ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_cache[3] || (_cache[3] = _createElementVNode(\"h2\", null, \"Настройка двухфакторной аутентификации\", -1 /* HOISTED */)), _createElementVNode(\"button\", {\n    onClick: _cache[0] || (_cache[0] = (...args) => _ctx.setupTwoFactor && _ctx.setupTwoFactor(...args))\n  }, \"Отправить код на почту\")])) : _createCommentVNode(\"v-if\", true), _ctx.showVerification ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_cache[4] || (_cache[4] = _createElementVNode(\"h3\", null, \"Введите код из электронной почты\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => _ctx.verificationCode = $event),\n    type: \"text\",\n    placeholder: \"Введите код подтверждения\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, _ctx.verificationCode]]), _createElementVNode(\"button\", {\n    onClick: _cache[2] || (_cache[2] = (...args) => _ctx.verifyCode && _ctx.verifyCode(...args))\n  }, \"Подтвердить\")])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_ctx","isEnabled","_hoisted_2","_createElementVNode","onClick","_cache","args","setupTwoFactor","_createCommentVNode","showVerification","_hoisted_3","$event","verificationCode","type","placeholder","verifyCode"],"sources":["C:\\Users\\Ясырь\\Documents\\GitHub\\Where2Go\\frontend\\src\\components\\TwoFactorSetup.vue"],"sourcesContent":["<template>\r\n  <div class=\"two-factor-setup\">\r\n    <div v-if=\"!isEnabled\" class=\"setup-section\">\r\n      <h2>Настройка двухфакторной аутентификации</h2>\r\n      <button @click=\"setupTwoFactor\">Отправить код на почту</button>\r\n    </div>\r\n    \r\n    <div v-if=\"showVerification\" class=\"verification-section\">\r\n      <h3>Введите код из электронной почты</h3>\r\n      <input \r\n        v-model=\"verificationCode\" \r\n        type=\"text\" \r\n        placeholder=\"Введите код подтверждения\"\r\n      />\r\n      <button @click=\"verifyCode\">Подтвердить</button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport api from '@/api/auth'\r\n\r\nexport default {\r\n  name: 'TwoFactorSetup',\r\n  data() {\r\n    return {\r\n      isEnabled: false,\r\n      showVerification: false,\r\n      verificationCode: ''\r\n    }\r\n  },\r\n  methods: {\r\n    async setupTwoFactor() {\r\n      try {\r\n        await api.generate2FASecret()\r\n        this.showVerification = true\r\n      } catch (error) {\r\n        console.error('Error setting up 2FA:', error)\r\n      }\r\n    },\r\n    \r\n    const getAuthHeaders = () => {\r\n      const token = localStorage.getItem('token');  // Получаем токен из localStorage\r\n      return {\r\n        headers: {\r\n          Authorization: `Token ${token}`  // Добавляем токен в заголовок\r\n        }\r\n      };\r\n    },\r\n\r\n    async verifyCode() {\r\n      try {\r\n        const response = await api.verify2FA(this.verificationCode, getAuthHeaders());\r\n        if (response.data.message === 'Успешная аутентификация.') {\r\n          this.$router.push('/home');\r\n        }\r\n      } catch (error) {\r\n        console.error('Ошибка проверки кода 2FA:', error);\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.two-factor-setup {\r\n  max-width: 400px;\r\n  margin: 0 auto;\r\n  padding: 20px;\r\n}\r\n\r\n.setup-section, .qr-section {\r\n  text-align: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.verification {\r\n  margin-top: 20px;\r\n}\r\n\r\ninput {\r\n  padding: 8px;\r\n  margin-right: 10px;\r\n}\r\n\r\nbutton {\r\n  padding: 8px 16px;\r\n  background-color: #4CAF50;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n}\r\n\r\nbutton:hover {\r\n  background-color: #45a049;\r\n}\r\n</style>\r\n"],"mappings":";;EACOA,KAAK,EAAC;AAAkB;;EAD/BC,GAAA;EAE2BD,KAAK,EAAC;;;EAFjCC,GAAA;EAOiCD,KAAK,EAAC;;;uBANrCE,mBAAA,CAeM,OAfNC,UAeM,G,CAdQC,IAAA,CAAAC,SAAS,I,cAArBH,mBAAA,CAGM,OAHNI,UAGM,G,0BAFJC,mBAAA,CAA+C,YAA3C,wCAAsC,sBAC1CA,mBAAA,CAA+D;IAAtDC,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEN,IAAA,CAAAO,cAAA,IAAAP,IAAA,CAAAO,cAAA,IAAAD,IAAA,CAAc;KAAE,wBAAsB,E,KAJ5DE,mBAAA,gBAOeR,IAAA,CAAAS,gBAAgB,I,cAA3BX,mBAAA,CAQM,OARNY,UAQM,G,0BAPJP,mBAAA,CAAyC,YAArC,kCAAgC,sB,gBACpCA,mBAAA,CAIE;IAbR,uBAAAE,MAAA,QAAAA,MAAA,MAAAM,MAAA,IAUiBX,IAAA,CAAAY,gBAAgB,GAAAD,MAAA;IACzBE,IAAI,EAAC,MAAM;IACXC,WAAW,EAAC;iDAFHd,IAAA,CAAAY,gBAAgB,E,GAI3BT,mBAAA,CAAgD;IAAvCC,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEN,IAAA,CAAAe,UAAA,IAAAf,IAAA,CAAAe,UAAA,IAAAT,IAAA,CAAU;KAAE,aAAW,E,KAd7CE,mBAAA,e","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}